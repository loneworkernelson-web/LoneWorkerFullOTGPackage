<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>On-the-Go AppSuite - Setup Tool</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <style>
    .step { display: none; }
    .step.active { display: block; }
    .step-nav button {
      transition: all 0.2s;
    }
    .step-nav button.current {
      background-color: #3b82f6;
      color: white;
      font-weight: 600;
    }
    .copy-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background-color: #4b5563;
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .copy-btn:hover { background-color: #6b7280; }
    .copy-btn.copied { background-color: #10b981; }
    strong { color: #60a5fa; font-weight: 600; }
    details > summary {
      cursor: pointer;
      color: #9ca3af;
      font-size: 0.75rem;
      margin-top: 0.25rem;
    }
    details > summary:hover { color: #60a5fa; }
    details ol {
      margin-top: 0.5rem;
      padding-left: 1.5rem;
      list-style-type: decimal;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4 md:p-8">
  <div class="max-w-4xl mx-auto bg-gray-800 rounded-lg shadow-xl overflow-hidden">

    <!-- Header -->
    <div class="bg-gray-900 p-6 border-b border-gray-700 text-center">
      <h1 class="text-3xl font-bold text-blue-400">On-the-Go AppSuite - Setup Tool</h1>
      <p class="text-gray-400 mt-2">Create your custom worker safety + reporting apps in minutes</p>
    </div>

    <!-- Step Navigation -->
    <div class="step-nav flex flex-wrap justify-center bg-gray-700 p-3 shadow-inner gap-2">
      <button type="button" id="nav1" class="current px-4 py-2 text-sm font-medium rounded-md" onclick="showStep(1)">1. Welcome</button>
      <button type="button" id="nav2" class="px-4 py-2 text-sm font-medium rounded-md text-gray-400" onclick="showStep(2)">2. Sheet Setup</button>
      <button type="button" id="nav3" class="px-4 py-2 text-sm font-medium rounded-md text-gray-400" onclick="showStep(3)">3. Config</button>
      <button type="button" id="nav4" class="px-4 py-2 text-sm font-medium rounded-md text-gray-400" onclick="showStep(4)">4. Download</button>
      <button type="button" id="nav5" class="px-4 py-2 text-sm font-medium rounded-md text-gray-400" onclick="showStep(5)">5. Done</button>
    </div>

    <div class="p-6 md:p-8 space-y-8">

      <!-- Step 1: Welcome -->
      <div id="step1" class="step active">
        <h2 class="text-2xl font-bold mb-6 text-blue-300">Welcome!</h2>
        <p class="text-gray-300 mb-6 leading-relaxed">
          This tool generates fully customized, offline-capable web apps for lone workers — with automatic check-ins, duress PINs, GPS tracking, and optional advanced reporting.
        </p>
        <div class="bg-gray-900 rounded-lg p-6 border border-gray-700 mb-6">
          <p class="text-lg mb-4">Choose your app type:</p>
          <div class="space-y-4">
            <label class="flex items-center p-4 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700 transition">
              <input type="radio" name="appType" value="simple" checked class="mr-4 h-5 w-5 text-blue-600">
              <div>
                <div class="font-semibold text-xl">Simple App (Safety Only)</div>
                <p class="text-gray-400">Timer + SOS + auto alerts. Perfect for most users.</p>
              </div>
            </label>
            <label class="flex items-center p-4 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700 transition">
              <input type="radio" name="appType" value="advanced" class="mr-4 h-5 w-5 text-blue-600">
              <div>
                <div class="font-semibold text-xl">Advanced App (Safety + Reporting)</div>
                <p class="text-gray-400">Everything above + dynamic report forms, photos, distance tracking.</p>
              </div>
            </label>
          </div>
        </div>
        <button onclick="nextStep()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg text-lg">
          Start Setup →
        </button>
      </div>

      <!-- Step 2: Google Sheet Setup -->
      <div id="step2" class="step">
        <h2 class="text-2xl font-bold mb-6 text-blue-300">Step 2: Create Your Google Sheet</h2>
        <ol class="list-decimal list-inside text-gray-300 space-y-4 text-lg mb-8">
          <li>Go to <a href="https://sheets.new" target="_blank" class="text-blue-400 underline">sheets.new</a> → create a blank sheet</li>
          <li>Rename it something like <strong>OTG Safety Log</strong></li>
          <li>Rename the first tab to exactly: <strong>Visits</strong></li>
          <li class="text-yellow-300">Advanced only: Add a second tab named exactly: <strong>Checklists</strong></li>
        </ol>

        <div class="relative bg-gray-900 rounded-lg p-6 font-mono text-sm text-gray-300 border border-gray-700 mb-6">
          <button type="button" onclick="copyToClipboard('headers')" class="copy-btn">Copy</button>
          <pre id="headers" class="overflow-x-auto">Date,Worker Name,Worker Phone Number,Emergency Contact Name,Emergency Contact Number,Emergency Contact Email,Escalation Contact Name,Escalation Contact Number,Escalation Contact Email,Location Name,Location Address,Arrival Time,Anticipated Departure Time,Actual Departure Time,Alarm Status,Notes,Last Known GPS,GPS Timestamp,Battery Level</pre>
        </div>
        <p class="text-gray-400 mb-6">Click "Copy" above → paste into cell A1 of your <strong>Visits</strong> tab</p>

        <button onclick="nextStep()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg text-lg">
          I Did This → Next
        </button>
      </div>

      <!-- Step 3: Configuration -->
      <div id="step3" class="step">
        <h2 class="text-2xl font-bold mb-6 text-blue-300">Step 3: Configure Your App</h2>
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium mb-2">Organisation Name</label>
            <input type="text" id="orgName" class="w-full px-4 py-3 bg-gray-700 rounded-lg" placeholder="e.g. SafeWork NZ" value="My Company">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Secret Key (for Monitor Dashboard)</label>
            <input type="password" id="secretKey" class="w-full px-4 py-3 bg-gray-700 rounded-lg" placeholder="Choose a strong password">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">OpenRouteService API Key (Optional)</label>
            <input type="text" id="orsKey" class="w-full px-4 py-3 bg-gray-700 rounded-lg" placeholder="Get free at openrouteservice.org">
            <p class="text-xs text-gray-500 mt-2">Enables auto distance calculation in reports</p>
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">First Alert After (minutes)</label>
            <input type="number" id="firstAlert" value="15" min="1" class="w-full px-4 py-3 bg-gray-700 rounded-lg">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Escalation Alert After (minutes)</label>
            <input type="number" id="escalation" value="5" min="1" class="w-full px-4 py-3 bg-gray-700 rounded-lg">
          </div>
          <div class="flex items-center space-x-3">
            <input type="checkbox" id="checkinEnabled" class="h-5 w-5 text-blue-600">
            <label>Enable "Are You OK?" check-ins every <input type="number" id="checkinInterval" value="30" class="w-20 px-2 py-1 bg-gray-700 rounded mx-2"> minutes</label>
          </div>
        </div>

        <button onclick="generateApps()" class="mt-8 w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg text-lg">
          Generate My Apps →
        </button>
      </div>

      <!-- Step 4: Download -->
      <div id="step4" class="step">
        <h2 class="text-2xl font-bold mb-6 text-blue-300">Step 4: Your Apps Are Ready!</h2>
        <div id="downloadSection" class="space-y-6">
          <!-- Filled in by JS -->
        </div>
      </div>

      <!-- Step 5: Done -->
      <div id="step5" class="step">
        <h2 class="text-2xl font-bold mb-6 text-green-400">All Done!</h2>
        <p class="text-xl text-gray-300 mb-6">Your apps are ready to deploy.</p>
        <div class="bg-gray-900 rounded-lg p-8 text-center">
          <p class="text-2xl mb-6">Next: Deploy your Google Apps Script</p>
          <a href="https://script.new" target="_blank" class="inline-block bg-blue-600 hover:bg-blue-700 px-8 py-4 rounded-lg text-xl font-bold">
            Open script.new → Paste Code
          </a>
        </div>
      </div>

    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 5;

    function showStep(n) {
      if (n < 1 || n > totalSteps) return;
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('step' + n).classList.add('active');
      document.querySelectorAll('.step-nav button').forEach(b => b.classList.remove('current'));
      document.getElementById('nav' + n).classList.add('current');
      currentStep = n;
    }

    function nextStep() {
      if (currentStep < totalSteps) showStep(currentStep + 1);
    }

    function copyToClipboard(id) {
      const text = document.getElementById(id).textContent;
      navigator.clipboard.writeText(text);
      const btn = document.querySelector(`button[onclick="copyToClipboard('${id}')"]`);
      btn.textContent = "Copied!";
      btn.classList.add('copied');
      setTimeout(() => {
        btn.textContent = "Copy";
        btn.classList.remove('copied');
      }, 2000);
    }

    async function generateApps() {
      const org = document.getElementById('orgName').value || "Worker App";
      const secret = document.getElementById('secretKey').value || "changeme";
      const ors = document.getElementById('orsKey').value;
      const appType = document.querySelector('input[name="appType"]:checked').value;

      // Placeholder — real version fetches from your GitHub templates
      alert("Generating your apps... (full version fetches templates from GitHub)");

      showStep(4);
      document.getElementById('downloadSection').innerHTML = `
        <div class="text-center py-12">
          <div class="inline-block animate-bounce text-6xl mb-6">Success</div>
          <p class="text-2xl mb-8">Your custom apps are ready!</p>
          <button class="bg-green-600 hover:bg-green-700 px-8 py-4 rounded-lg text-xl font-bold">
            Download ZIP (Coming in full version)
          </button>
        </div>
      `;
      setTimeout(() => showStep(5), 3000);
    }
  </script>
</body>
</html>
